{% extends "base.html" %}

{% block title %}3D 立方體展示{% endblock title %}

{% block content %}
<canvas id="threeCanvas"
        style="width:100%;height:80vh;display:block;background:#000;"></canvas>
{% endblock content %}

{% block scripts %}
<!-- 把裸模組 "three" 映射到真正檔案位置 -->
<script type="importmap">
{
  "imports": {
    "three": "https://unpkg.com/three@0.163.0/build/three.module.js"
  }
}
</script>

<script type="module">
import * as THREE from 'three';
import { OrbitControls } from 'https://unpkg.com/three@0.163.0/examples/jsm/controls/OrbitControls.js?module';

const canvas    = document.getElementById('threeCanvas');
const renderer  = new THREE.WebGLRenderer({ canvas, antialias: true });
const scene     = new THREE.Scene();
const camera    = new THREE.PerspectiveCamera(60, 1, 0.1, 1000);
camera.position.set(3, 2, 3);

/* ---------- 滑鼠控制 ---------- */
const controls = new OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.dampingFactor = 0.1;
controls.enablePan     = false;
controls.minDistance   = 2;
controls.maxDistance   = 10;

/* ---------- 立方體與光源 ---------- */
scene.add(new THREE.Mesh(
  new THREE.BoxGeometry(1, 1, 1),
  new THREE.MeshStandardMaterial({ color: 0x2C2C2C })
  
));

const light = new THREE.DirectionalLight(0xffffff, 1);
light.position.set(5, 5, 5).normalize();
scene.background = new THREE.Color(0x2C2C2C);
scene.add(light);

/* ---------- 自適應尺寸 ---------- */
function onResize() {
  const w = canvas.clientWidth,
        h = canvas.clientHeight;
  camera.aspect = w / h;
  camera.updateProjectionMatrix();
  renderer.setSize(w, h, false);
}
window.addEventListener('resize', onResize);
onResize();

/* ---------- 主迴圈 ---------- */
(function animate() {
  requestAnimationFrame(animate);
  controls.update();
  renderer.render(scene, camera);
})();
</script>
{% endblock scripts %}
